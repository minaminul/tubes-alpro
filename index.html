<!doctype html>
<html lang="id" class="scroll-smooth">
 <head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>MinaMetrics - Professional Land Surveying</title>
  <script src="/_sdk/element_sdk.js"></script>
  <script src="https://cdn.tailwindcss.com"></script>
  <style>
        body {
            box-sizing: border-box;
        }
        
        .glass {
            background: rgba(255, 255, 255, 0.2);
            backdrop-filter: blur(20px);
            border: 1px solid rgba(255, 255, 255, 0.3);
        }
        
        .gradient-bg {
            background: linear-gradient(135deg, #ffffff 0%, #dbeafe 50%, #3b82f6 100%);
        }
        
        .gradient-text {
            background: linear-gradient(135deg, #3b82f6, #0ea5e9);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }
        
        .glow-blue {
            box-shadow: 0 0 20px rgba(59, 130, 246, 0.3);
        }
        
        .hover-glow:hover {
            box-shadow: 0 8px 32px rgba(59, 130, 246, 0.4);
            transform: translateY(-8px);
        }
        
        .nav-link {
            position: relative;
            transition: all 0.3s ease;
        }
        
        .nav-link::after {
            content: '';
            position: absolute;
            bottom: -4px;
            left: 0;
            width: 0;
            height: 2px;
            background: linear-gradient(135deg, #3b82f6, #0ea5e9);
            transition: width 0.3s ease;
        }
        
        .nav-link:hover::after {
            width: 100%;
        }
        
        .fade-in {
            opacity: 0;
            transform: translateY(20px);
            animation: fadeIn 0.8s ease forwards;
        }
        
        .slide-in-left {
            opacity: 0;
            transform: translateX(-50px);
            animation: slideInLeft 0.8s ease forwards;
        }
        
        .slide-in-right {
            opacity: 0;
            transform: translateX(50px);
            animation: slideInRight 0.8s ease forwards;
        }
        
        @keyframes fadeIn {
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }
        
        @keyframes slideInLeft {
            to {
                opacity: 1;
                transform: translateX(0);
            }
        }
        
        @keyframes slideInRight {
            to {
                opacity: 1;
                transform: translateX(0);
            }
        }
        
        .timeline-item {
            position: relative;
            padding-left: 2rem;
        }
        
        .timeline-item::before {
            content: '';
            position: absolute;
            left: 0;
            top: 0;
            width: 2px;
            height: 100%;
            background: linear-gradient(135deg, #3b82f6, #0ea5e9);
        }
        
        .timeline-item-horizontal {
            position: relative;
            padding: 1rem;
        }
        
        .timeline-year {
            background: linear-gradient(135deg, #3b82f6, #0ea5e9);
            color: white;
            padding: 0.5rem 1rem;
            border-radius: 0.5rem;
            font-weight: bold;
            display: inline-block;
            margin-bottom: 0.5rem;
        }
        
        .btn-gradient {
            background: linear-gradient(135deg, #3b82f6, #0ea5e9);
            transition: all 0.3s ease;
        }
        
        .btn-gradient:hover {
            transform: scale(1.05);
            box-shadow: 0 8px 25px rgba(59, 130, 246, 0.4);
        }
        
        .btn-glass {
            background: rgba(255, 255, 255, 0.2);
            backdrop-filter: blur(20px);
            border: 1px solid rgba(255, 255, 255, 0.3);
            transition: all 0.3s ease;
        }
        
        .btn-glass:hover {
            background: rgba(255, 255, 255, 0.3);
            transform: scale(1.05);
        }
        
        .section-heading {
            position: relative;
            text-align: center;
            margin-bottom: 3rem;
        }
        
        .section-heading::after {
            content: '';
            position: absolute;
            bottom: -10px;
            left: 50%;
            transform: translateX(-50%);
            width: 60px;
            height: 3px;
            background: linear-gradient(135deg, #3b82f6, #0ea5e9);
            border-radius: 2px;
        }
        
        .surveyor-tab {
            transition: all 0.3s ease;
            border-bottom: 3px solid transparent;
        }
        
        .surveyor-tab.active {
            background: linear-gradient(135deg, #3b82f6, #0ea5e9);
            color: white;
            border-bottom-color: #0ea5e9;
        }
        
        .surveyor-tab:hover:not(.active) {
            background: rgba(59, 130, 246, 0.1);
            color: #3b82f6;
        }
        
        .polygon-tab {
            transition: all 0.3s ease;
            border-bottom: 2px solid transparent;
        }
        
        .polygon-tab.active {
            border-bottom-color: #3b82f6;
            color: #3b82f6;
        }
        
        .result-box {
            background: linear-gradient(135deg, #dbeafe, #bfdbfe);
            border: 2px solid #3b82f6;
        }
        
        #mobile-menu {
            transform: translateX(100%);
            transition: transform 0.3s ease;
        }
        
        #mobile-menu.active {
            transform: translateX(0);
        }
    </style>
  <style>@view-transition { navigation: auto; }</style>
  <script src="/_sdk/data_sdk.js" type="text/javascript"></script>
 </head>
 <body class="gradient-bg min-h-full"><!-- Navbar -->
  <nav class="fixed top-0 w-full z-50 glass">
   <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
    <div class="flex justify-between items-center h-16">
     <div class="flex-shrink-0">
      <h1 class="text-2xl font-bold gradient-text" id="brand-name">MinaMetrics</h1>
     </div><!-- Desktop Menu -->
     <div class="hidden md:block">
      <div class="ml-10 flex items-baseline space-x-8"><button onclick="navigateToPage('home')" class="nav-link text-gray-700 hover:text-blue-600 px-3 py-2 text-sm font-medium">Beranda</button> <button onclick="navigateToPage('about')" class="nav-link text-gray-700 hover:text-blue-600 px-3 py-2 text-sm font-medium">Tentang</button> <button onclick="navigateToPage('services')" class="nav-link text-gray-700 hover:text-blue-600 px-3 py-2 text-sm font-medium">Layanan</button> <button onclick="navigateToPage('calculator')" class="nav-link text-gray-700 hover:text-blue-600 px-3 py-2 text-sm font-medium">Kalkulator</button> <button onclick="navigateToPage('partner')" class="nav-link text-gray-700 hover:text-blue-600 px-3 py-2 text-sm font-medium">Partner</button> <button onclick="navigateToPage('contact')" class="nav-link text-gray-700 hover:text-blue-600 px-3 py-2 text-sm font-medium">Kontak</button>
      </div>
     </div><!-- Mobile menu button -->
     <div class="md:hidden"><button id="mobile-menu-btn" class="text-gray-700 hover:text-blue-600 focus:outline-none">
       <svg class="h-6 w-6" fill="none" viewbox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16" />
       </svg></button>
     </div>
    </div>
   </div><!-- Mobile Menu -->
   <div id="mobile-menu" class="md:hidden fixed top-16 right-0 w-64 h-full glass">
    <div class="px-2 pt-2 pb-3 space-y-1"><button onclick="navigateToPage('home')" class="block w-full text-left px-3 py-2 text-gray-700 hover:text-blue-600">Beranda</button> <button onclick="navigateToPage('about')" class="block w-full text-left px-3 py-2 text-gray-700 hover:text-blue-600">Tentang</button> <button onclick="navigateToPage('services')" class="block w-full text-left px-3 py-2 text-gray-700 hover:text-blue-600">Layanan</button> <button onclick="navigateToPage('calculator')" class="block w-full text-left px-3 py-2 text-gray-700 hover:text-blue-600">Kalkulator</button> <button onclick="navigateToPage('partner')" class="block w-full text-left px-3 py-2 text-gray-700 hover:text-blue-600">Partner</button> <button onclick="navigateToPage('contact')" class="block w-full text-left px-3 py-2 text-gray-700 hover:text-blue-600">Kontak</button>
    </div>
   </div>
  </nav><!-- Main Content Container -->
  <div class="pt-20 min-h-screen"><!-- Page Content Area -->
   <div class="w-full" id="page-content"><!-- Home Page (Default) -->
    <div id="home-page" class="page-content">
     <section class="min-h-screen p-8">
      <div class="max-w-6xl mx-auto"><!-- Hero Area -->
       <div class="grid grid-cols-1 lg:grid-cols-2 gap-12 items-center mb-16"><!-- Left Column -->
        <div class="slide-in-left">
         <p class="text-blue-600 font-semibold mb-4" id="hero-tagline">Teknologi Survey Terdepan</p>
         <h1 class="text-4xl lg:text-5xl font-bold text-gray-900 mb-6" id="hero-title">Solusi Survey Profesional untuk Masa Depan</h1>
         <p class="text-lg text-gray-600 mb-8" id="hero-description">Dengan teknologi terdepan dan tim berpengalaman, kami memberikan layanan survey topografi, pemetaan GPS, dan analisis kontur yang akurat untuk proyek konstruksi dan infrastruktur Anda.</p>
         <div class="flex flex-col sm:flex-row gap-4"><button onclick="navigateToPage('contact')" class="btn-gradient text-white px-8 py-3 rounded-lg font-semibold">Konsultasi Gratis</button> <button onclick="navigateToPage('services')" class="btn-glass text-gray-700 px-8 py-3 rounded-lg font-semibold">Lihat Layanan</button>
         </div>
        </div><!-- Right Column - SVG Illustration -->
        <div class="slide-in-right">
         <svg viewbox="0 0 400 300" class="w-full h-auto"><!-- Background --> <defs>
           <lineargradient id="skyGradient" x1="0%" y1="0%" x2="0%" y2="100%">
            <stop offset="0%" style="stop-color:#7dd3fc;stop-opacity:0.3" />
            <stop offset="100%" style="stop-color:#3b82f6;stop-opacity:0.1" />
           </lineargradient>
           <lineargradient id="equipmentGradient" x1="0%" y1="0%" x2="100%" y2="100%">
            <stop offset="0%" style="stop-color:#3b82f6" />
            <stop offset="100%" style="stop-color:#0ea5e9" />
           </lineargradient>
          </defs> <!-- Sky --> <rect width="400" height="150" fill="url(#skyGradient)" /> <!-- Ground --> <path d="M0 150 Q100 140 200 145 T400 150 L400 300 L0 300 Z" fill="#10b981" opacity="0.3" /> <path d="M0 160 Q150 150 300 155 T400 160 L400 300 L0 300 Z" fill="#059669" opacity="0.2" /> <!-- Survey Equipment (Total Station) --> <g transform="translate(180, 120)"><!-- Tripod -->
           <line x1="0" y1="30" x2="-25" y2="80" stroke="url(#equipmentGradient)" stroke-width="3" />
           <line x1="0" y1="30" x2="25" y2="80" stroke="url(#equipmentGradient)" stroke-width="3" />
           <line x1="0" y1="30" x2="0" y2="80" stroke="url(#equipmentGradient)" stroke-width="3" /> <!-- Equipment Body -->
           <rect x="-15" y="10" width="30" height="20" fill="url(#equipmentGradient)" rx="3" />
           <circle cx="0" cy="20" r="8" fill="#0ea5e9" />
           <circle cx="0" cy="20" r="4" fill="#ffffff" /> <!-- Telescope -->
           <rect x="-20" y="17" width="40" height="6" fill="url(#equipmentGradient)" rx="3" />
          </g> <!-- Survey Markers --> <g fill="url(#equipmentGradient)">
           <circle cx="80" cy="180" r="4" />
           <rect x="76" y="160" width="8" height="20" />
           <circle cx="320" cy="170" r="4" />
           <rect x="316" y="150" width="8" height="20" />
           <circle cx="150" cy="190" r="4" />
           <rect x="146" y="170" width="8" height="20" />
          </g> <!-- Measurement Lines --> <g stroke="#3b82f6" stroke-width="2" stroke-dasharray="5,5" opacity="0.7">
           <line x1="80" y1="180" x2="180" y2="150" />
           <line x1="180" y1="150" x2="320" y2="170" />
           <line x1="320" y1="170" x2="150" y2="190" />
          </g> <!-- Elevation Lines --> <g stroke="#0ea5e9" stroke-width="1" opacity="0.5">
           <path d="M50 200 Q150 190 250 195 T350 200" fill="none" />
           <path d="M50 210 Q150 200 250 205 T350 210" fill="none" />
           <path d="M50 220 Q150 210 250 215 T350 220" fill="none" />
          </g> <!-- Distance Labels --> <g fill="#3b82f6" font-family="Arial" font-size="10" text-anchor="middle">
           <text x="130" y="165">
            125.5m
           </text>
           <text x="250" y="155">
            89.2m
           </text>
           <text x="235" y="185">
            156.8m
           </text>
          </g>
         </svg>
        </div>
       </div><!-- Company Overview -->
       <div class="grid grid-cols-1 md:grid-cols-2 gap-8 mb-12">
        <div class="glass rounded-2xl p-8 fade-in">
         <h3 class="text-2xl font-bold text-gray-900 mb-4">Tentang MinaMetrics</h3>
         <p class="text-gray-600 mb-4">Perusahaan survey dan pemetaan profesional yang telah berpengalaman lebih dari 6 tahun dalam memberikan solusi geospasial terdepan untuk berbagai proyek infrastruktur di Indonesia.</p>
         <p class="text-gray-600">Dengan tim ahli bersertifikat dan teknologi modern, kami berkomitmen memberikan hasil survey yang akurat dan tepat waktu.</p>
        </div>
        <div class="glass rounded-2xl p-8 fade-in">
         <h3 class="text-2xl font-bold text-gray-900 mb-4">Mengapa Memilih Kami?</h3>
         <ul class="space-y-3">
          <li class="flex items-start">
           <div class="w-2 h-2 bg-blue-500 rounded-full mt-2 mr-3 flex-shrink-0"></div><span class="text-gray-700">Akurasi tinggi dengan teknologi GPS RTK</span></li>
          <li class="flex items-start">
           <div class="w-2 h-2 bg-blue-500 rounded-full mt-2 mr-3 flex-shrink-0"></div><span class="text-gray-700">Tim surveyor bersertifikat internasional</span></li>
          <li class="flex items-start">
           <div class="w-2 h-2 bg-blue-500 rounded-full mt-2 mr-3 flex-shrink-0"></div><span class="text-gray-700">Pengalaman 100+ proyek sukses</span></li>
          <li class="flex items-start">
           <div class="w-2 h-2 bg-blue-500 rounded-full mt-2 mr-3 flex-shrink-0"></div><span class="text-gray-700">Layanan konsultasi gratis</span></li>
         </ul>
        </div>
       </div><!-- Quick Features -->
       <div class="grid grid-cols-1 md:grid-cols-3 gap-8"><!-- Survey Akurat -->
        <div class="glass rounded-2xl p-8 text-center hover-glow transition-all duration-300 fade-in cursor-pointer" onclick="navigateToPage('services')">
         <div class="w-16 h-16 mx-auto mb-6 rounded-full bg-gradient-to-r from-blue-500 to-cyan-500 flex items-center justify-center">
          <svg class="w-8 h-8 text-white" fill="none" stroke="currentColor" viewbox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 20l-5.447-2.724A1 1 0 013 16.382V5.618a1 1 0 011.447-.894L9 7m0 13l6-3m-6 3V7m6 10l4.553 2.276A1 1 0 0021 18.382V7.618a1 1 0 00-1.447-.894L15 4m0 13V4m0 0L9 7" />
          </svg>
         </div>
         <h3 class="text-xl font-bold text-gray-900 mb-4">Survey Akurat</h3>
         <p class="text-gray-600">Teknologi GPS RTK dengan akurasi hingga centimeter untuk hasil survey yang presisi.</p>
        </div><!-- Kalkulator Online -->
        <div class="glass rounded-2xl p-8 text-center hover-glow transition-all duration-300 fade-in cursor-pointer" style="animation-delay: 0.2s;" onclick="navigateToPage('calculator')">
         <div class="w-16 h-16 mx-auto mb-6 rounded-full bg-gradient-to-r from-blue-500 to-cyan-500 flex items-center justify-center">
          <svg class="w-8 h-8 text-white" fill="none" stroke="currentColor" viewbox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 7h6m0 10v-3m-3 3h.01M9 17h.01M9 14h.01M12 14h.01M15 11h.01M12 11h.01M9 11h.01M7 21h10a2 2 0 002-2V5a2 2 0 00-2-2H7a2 2 0 00-2 2v14a2 2 0 002 2z" />
          </svg>
         </div>
         <h3 class="text-xl font-bold text-gray-900 mb-4">Kalkulator Online</h3>
         <p class="text-gray-600">Tools perhitungan jarak, luas, dan volume tanah yang mudah digunakan dan akurat.</p>
        </div><!-- Konsultasi Gratis -->
        <div class="glass rounded-2xl p-8 text-center hover-glow transition-all duration-300 fade-in cursor-pointer" style="animation-delay: 0.4s;" onclick="navigateToPage('contact')">
         <div class="w-16 h-16 mx-auto mb-6 rounded-full bg-gradient-to-r from-blue-500 to-cyan-500 flex items-center justify-center">
          <svg class="w-8 h-8 text-white" fill="none" stroke="currentColor" viewbox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 12h.01M12 12h.01M16 12h.01M21 12c0 4.418-4.03 8-9 8a9.863 9.863 0 01-4.255-.949L3 20l1.395-3.72C3.512 15.042 3 13.574 3 12c0-4.418 4.03-8 9-8s9 3.582 9 8z" />
          </svg>
         </div>
         <h3 class="text-xl font-bold text-gray-900 mb-4">Konsultasi Gratis</h3>
         <p class="text-gray-600">Dapatkan konsultasi gratis untuk kebutuhan survey proyek Anda dari tim ahli kami.</p>
        </div>
       </div>
      </div>
     </section>
    </div><!-- Calculator Page -->
    <div id="calculator-page" class="page-content hidden">
     <section class="min-h-screen p-8">
      <div class="max-w-7xl mx-auto">
       <h2 class="text-3xl font-bold text-gray-900 mb-12 text-center">Kalkulator Surveyor &amp; Kontur</h2>
       <div class="bg-white rounded-3xl shadow-2xl p-8 fade-in"><!-- Navigation Tabs -->
        <div class="flex flex-wrap justify-center mb-8 border-b border-gray-200"><button class="surveyor-tab active px-6 py-3 font-semibold rounded-t-lg transition-all duration-300" data-tab="polygon">
          <svg class="w-5 h-5 inline-block mr-2" fill="none" stroke="currentColor" viewbox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 20l-5.447-2.724A1 1 0 013 16.382V5.618a1 1 0 011.447-.894L9 7m0 13l6-3m-6 3V7m6 10l4.553 2.276A1 1 0 0021 18.382V7.618a1 1 0 00-1.447-.894L15 4m0 13V4m0 0L9 7" />
          </svg> Poligon </button> <button class="surveyor-tab px-6 py-3 font-semibold rounded-t-lg transition-all duration-300" data-tab="grid">
          <svg class="w-5 h-5 inline-block mr-2" fill="none" stroke="currentColor" viewbox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 5a1 1 0 011-1h14a1 1 0 011 1v2a1 1 0 01-1 1H5a1 1 0 01-1-1V5zM4 13a1 1 0 011-1h6a1 1 0 011 1v6a1 1 0 01-1 1H5a1 1 0 01-1-1v-6zM16 13a1 1 0 011-1h2a1 1 0 011 1v6a1 1 0 01-1 1h-2a1 1 0 01-1-1v-6z" />
          </svg> Grid </button> <button class="surveyor-tab px-6 py-3 font-semibold rounded-t-lg transition-all duration-300" data-tab="profile">
          <svg class="w-5 h-5 inline-block mr-2" fill="none" stroke="currentColor" viewbox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z" />
          </svg> Profil/Transek </button> <button class="surveyor-tab px-6 py-3 font-semibold rounded-t-lg transition-all duration-300" data-tab="random">
          <svg class="w-5 h-5 inline-block mr-2" fill="none" stroke="currentColor" viewbox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17.657 16.657L13.414 20.9a1.998 1.998 0 01-2.827 0l-4.244-4.243a8 8 0 1111.314 0z" /> <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 11a3 3 0 11-6 0 3 3 0 016 0z" />
          </svg> Titik Acak </button>
        </div><!-- Polygon Module - SISTEM BARU SESUAI KETENTUAN KLIEN -->
        <div id="polygon-calc" class="surveyor-content">
         <div class="grid grid-cols-1 xl:grid-cols-3 gap-8"><!-- Input Section -->
          <div class="xl:col-span-1">
           <h3 class="text-xl font-bold text-gray-900 mb-6">Input Data Poligon</h3><!-- Tab untuk Main Points dan Sub Points -->
           <div class="flex mb-4 border-b border-gray-200"><button id="main-point-tab" class="polygon-tab active px-4 py-2 font-semibold" onclick="switchPolygonTab('main')">Titik Utama</button> <button id="sub-point-tab" class="polygon-tab px-4 py-2 font-semibold" onclick="switchPolygonTab('sub')">Titik Turunan</button>
           </div><!-- Input Titik Utama (A, B, C... dengan X,Y saja) -->
           <div id="main-point-input" class="space-y-4 mb-6">
            <div class="bg-blue-50 p-3 rounded-lg text-sm text-blue-700"><strong>Titik Utama:</strong> Hanya huruf besar (A, B, C...) dengan koordinat X dan Y
            </div>
            <div class="grid grid-cols-3 gap-2"><input type="text" placeholder="Nama (A,B,C...)" maxlength="1" pattern="[A-Z]" class="p-3 border border-gray-300 rounded-lg polygon-main-name" style="text-transform: uppercase;"> <input type="number" placeholder="X (m)" step="0.001" class="p-3 border border-gray-300 rounded-lg polygon-main-x"> <input type="number" placeholder="Y (m)" step="0.001" class="p-3 border border-gray-300 rounded-lg polygon-main-y">
            </div><button onclick="addMainPoint()" class="w-full btn-gradient text-white px-4 py-2 rounded-lg font-semibold">Tambah Titik Utama</button>
           </div><!-- Input Titik Turunan (A1, A2... dengan Z) -->
           <div id="sub-point-input" class="space-y-4 mb-6 hidden">
            <div class="bg-green-50 p-3 rounded-lg text-sm text-green-700"><strong>Titik Turunan:</strong> Format A1, A2, B1... dengan elevasi Z pada koordinat X-Y titik utama
            </div>
            <div class="grid grid-cols-3 gap-2"><select class="p-3 border border-gray-300 rounded-lg polygon-sub-main"> <option value="">Pilih Titik Utama</option> </select> <input type="text" placeholder="Nama (A1,A2...)" class="p-3 border border-gray-300 rounded-lg polygon-sub-name"> <input type="number" placeholder="Z (m)" step="0.001" class="p-3 border border-gray-300 rounded-lg polygon-sub-z">
            </div><button onclick="addSubPoint()" class="w-full btn-gradient text-white px-4 py-2 rounded-lg font-semibold">Tambah Titik Turunan</button>
           </div>
           <div class="space-y-3"><button onclick="calculatePolygon()" class="w-full bg-blue-600 hover:bg-blue-700 text-white px-4 py-3 rounded-lg font-semibold">Hitung Poligon</button> <button onclick="loadSampleData('polygon')" class="w-full bg-gray-600 hover:bg-gray-700 text-white px-4 py-2 rounded-lg font-semibold">üìã Load Data Contoh</button> <button onclick="clearData('polygon')" class="w-full bg-red-600 hover:bg-red-700 text-white px-4 py-2 rounded-lg font-semibold">üóëÔ∏è Clear Data</button> <button onclick="exportPolygonData('csv')" class="w-full bg-green-600 hover:bg-green-700 text-white px-4 py-2 rounded-lg font-semibold">Ekspor CSV</button> <button onclick="exportPolygonData('json')" class="w-full bg-purple-600 hover:bg-purple-700 text-white px-4 py-2 rounded-lg font-semibold">Ekspor JSON</button>
           </div>
          </div><!-- Results Section -->
          <div class="xl:col-span-2">
           <h3 class="text-xl font-bold text-gray-900 mb-6">Hasil Perhitungan</h3><!-- Summary Stats -->
           <div class="grid grid-cols-2 md:grid-cols-4 gap-4 mb-6">
            <div class="bg-blue-50 border border-blue-200 rounded-lg p-4 text-center">
             <h5 class="font-semibold text-blue-800 mb-1">Perimeter</h5>
             <p id="polygon-perimeter" class="text-lg font-bold text-blue-600">0.00 m</p>
            </div>
            <div class="bg-green-50 border border-green-200 rounded-lg p-4 text-center">
             <h5 class="font-semibold text-green-800 mb-1">Luas</h5>
             <p id="polygon-area" class="text-lg font-bold text-green-600">0.00 m¬≤</p>
            </div>
            <div class="bg-purple-50 border border-purple-200 rounded-lg p-4 text-center">
             <h5 class="font-semibold text-purple-800 mb-1">Titik Utama</h5>
             <p id="polygon-main-count" class="text-lg font-bold text-purple-600">0</p>
            </div>
            <div class="bg-orange-50 border border-orange-200 rounded-lg p-4 text-center">
             <h5 class="font-semibold text-orange-800 mb-1">Titik Turunan</h5>
             <p id="polygon-sub-count" class="text-lg font-bold text-orange-600">0</p>
            </div>
           </div><!-- Tabel Titik Utama -->
           <div class="mb-6">
            <h4 class="font-semibold text-gray-700 mb-3">Tabel Titik Utama (Azimuth &amp; Jarak)</h4>
            <div class="overflow-x-auto">
             <table class="w-full border-collapse border border-gray-300 rounded-lg">
              <thead class="bg-blue-50">
               <tr>
                <th class="border border-gray-300 px-4 py-2 text-left">Titik</th>
                <th class="border border-gray-300 px-4 py-2 text-right">X (m)</th>
                <th class="border border-gray-300 px-4 py-2 text-right">Y (m)</th>
                <th class="border border-gray-300 px-4 py-2 text-right">Azimuth (¬∞)</th>
                <th class="border border-gray-300 px-4 py-2 text-right">Jarak (m)</th>
                <th class="border border-gray-300 px-4 py-2 text-center">Aksi</th>
               </tr>
              </thead>
              <tbody id="polygon-main-table-body">
               <tr>
                <td colspan="6" class="border border-gray-300 px-4 py-8 text-center text-gray-500">Belum ada titik utama</td>
               </tr>
              </tbody>
             </table>
            </div>
           </div><!-- Tabel Titik Turunan -->
           <div class="mb-6">
            <h4 class="font-semibold text-gray-700 mb-3">Tabel Titik Turunan (Elevasi &amp; Analisis Vertikal)</h4>
            <div class="overflow-x-auto">
             <table class="w-full border-collapse border border-gray-300 rounded-lg">
              <thead class="bg-green-50">
               <tr>
                <th class="border border-gray-300 px-4 py-2 text-left">Titik</th>
                <th class="border border-gray-300 px-4 py-2 text-left">Titik Utama</th>
                <th class="border border-gray-300 px-4 py-2 text-right">X (m)</th>
                <th class="border border-gray-300 px-4 py-2 text-right">Y (m)</th>
                <th class="border border-gray-300 px-4 py-2 text-right">Z (m)</th>
                <th class="border border-gray-300 px-4 py-2 text-right">Kemiringan (%)</th>
                <th class="border border-gray-300 px-4 py-2 text-center">Aksi</th>
               </tr>
              </thead>
              <tbody id="polygon-sub-table-body">
               <tr>
                <td colspan="7" class="border border-gray-300 px-4 py-8 text-center text-gray-500">Belum ada titik turunan</td>
               </tr>
              </tbody>
             </table>
            </div>
           </div><!-- Visualization -->
           <div class="mt-6">
            <h4 class="font-semibold text-gray-700 mb-3">Preview Poligon</h4>
            <div id="polygon-preview" class="border border-gray-300 rounded-lg bg-gray-50 h-64 flex items-center justify-center">
             <p class="text-gray-500">Tambahkan minimal 3 titik utama untuk melihat preview</p>
            </div>
           </div>
          </div>
         </div>
        </div><!-- Grid Module -->
        <div id="grid-calc" class="surveyor-content hidden">
         <div class="grid grid-cols-1 xl:grid-cols-3 gap-8"><!-- Input Section -->
          <div class="xl:col-span-1">
           <h3 class="text-xl font-bold text-gray-900 mb-6">Input Data Grid</h3>
           <div class="space-y-4 mb-6">
            <div class="grid grid-cols-4 gap-2"><input type="text" placeholder="Nama" class="p-3 border border-gray-300 rounded-lg grid-name"> <input type="number" placeholder="X (m)" step="0.001" class="p-3 border border-gray-300 rounded-lg grid-x"> <input type="number" placeholder="Y (m)" step="0.001" class="p-3 border border-gray-300 rounded-lg grid-y"> <input type="number" placeholder="Z (m)" step="0.001" class="p-3 border border-gray-300 rounded-lg grid-z">
            </div><button onclick="addGridPoint()" class="w-full btn-gradient text-white px-4 py-2 rounded-lg font-semibold">Tambah Titik Grid</button>
           </div>
           <div class="space-y-3"><button onclick="calculateGrid()" class="w-full bg-blue-600 hover:bg-blue-700 text-white px-4 py-3 rounded-lg font-semibold">Hitung Grid</button> <button onclick="loadSampleData('grid')" class="w-full bg-gray-600 hover:bg-gray-700 text-white px-4 py-2 rounded-lg font-semibold">üìã Load Data Contoh</button> <button onclick="clearData('grid')" class="w-full bg-red-600 hover:bg-red-700 text-white px-4 py-2 rounded-lg font-semibold">üóëÔ∏è Clear Data</button> <button onclick="exportData('grid', 'csv')" class="w-full bg-green-600 hover:bg-green-700 text-white px-4 py-2 rounded-lg font-semibold">Ekspor CSV</button>
           </div>
          </div><!-- Results Section -->
          <div class="xl:col-span-2">
           <h3 class="text-xl font-bold text-gray-900 mb-6">Hasil Perhitungan Grid</h3>
           <div class="grid grid-cols-2 md:grid-cols-3 gap-4 mb-6">
            <div class="bg-blue-50 border border-blue-200 rounded-lg p-4 text-center">
             <h5 class="font-semibold text-blue-800 mb-1">Total Titik</h5>
             <p id="grid-count" class="text-lg font-bold text-blue-600">0</p>
            </div>
            <div class="bg-green-50 border border-green-200 rounded-lg p-4 text-center">
             <h5 class="font-semibold text-green-800 mb-1">Elevasi Rata-rata</h5>
             <p id="grid-avg-elevation" class="text-lg font-bold text-green-600">0.00 m</p>
            </div>
            <div class="bg-purple-50 border border-purple-200 rounded-lg p-4 text-center">
             <h5 class="font-semibold text-purple-800 mb-1">Range Elevasi</h5>
             <p id="grid-elevation-range" class="text-lg font-bold text-purple-600">0.00 m</p>
            </div>
           </div>
           <div class="overflow-x-auto">
            <table class="w-full border-collapse border border-gray-300 rounded-lg">
             <thead class="bg-blue-50">
              <tr>
               <th class="border border-gray-300 px-4 py-2 text-left">Nama</th>
               <th class="border border-gray-300 px-4 py-2 text-right">X (m)</th>
               <th class="border border-gray-300 px-4 py-2 text-right">Y (m)</th>
               <th class="border border-gray-300 px-4 py-2 text-right">Z (m)</th>
               <th class="border border-gray-300 px-4 py-2 text-center">Aksi</th>
              </tr>
             </thead>
             <tbody id="grid-table-body">
              <tr>
               <td colspan="5" class="border border-gray-300 px-4 py-8 text-center text-gray-500">Belum ada data grid</td>
              </tr>
             </tbody>
            </table>
           </div>
           <div class="mt-6">
            <h4 class="font-semibold text-gray-700 mb-3">Preview Grid</h4>
            <div id="grid-preview" class="border border-gray-300 rounded-lg bg-gray-50 h-64 flex items-center justify-center">
             <p class="text-gray-500">Tambahkan titik grid untuk melihat preview</p>
            </div>
           </div>
          </div>
         </div>
        </div><!-- Profile/Transek Module -->
        <div id="profile-calc" class="surveyor-content hidden">
         <div class="grid grid-cols-1 xl:grid-cols-3 gap-8"><!-- Input Section -->
          <div class="xl:col-span-1">
           <h3 class="text-xl font-bold text-gray-900 mb-6">Input Data Profil/Transek</h3>
           <div class="space-y-4 mb-6">
            <div class="grid grid-cols-3 gap-2"><input type="text" placeholder="Nama" class="p-3 border border-gray-300 rounded-lg profile-name"> <input type="number" placeholder="Jarak (m)" step="0.001" class="p-3 border border-gray-300 rounded-lg profile-distance"> <input type="number" placeholder="Elevasi (m)" step="0.001" class="p-3 border border-gray-300 rounded-lg profile-elevation">
            </div><button onclick="addProfilePoint()" class="w-full btn-gradient text-white px-4 py-2 rounded-lg font-semibold">Tambah Titik Profil</button>
           </div>
           <div class="space-y-3"><button onclick="calculateProfile()" class="w-full bg-blue-600 hover:bg-blue-700 text-white px-4 py-3 rounded-lg font-semibold">Hitung Profil</button> <button onclick="loadSampleData('profile')" class="w-full bg-gray-600 hover:bg-gray-700 text-white px-4 py-2 rounded-lg font-semibold">üìã Load Data Contoh</button> <button onclick="clearData('profile')" class="w-full bg-red-600 hover:bg-red-700 text-white px-4 py-2 rounded-lg font-semibold">üóëÔ∏è Clear Data</button> <button onclick="exportData('profile', 'csv')" class="w-full bg-green-600 hover:bg-green-700 text-white px-4 py-2 rounded-lg font-semibold">Ekspor CSV</button>
           </div>
          </div><!-- Results Section -->
          <div class="xl:col-span-2">
           <h3 class="text-xl font-bold text-gray-900 mb-6">Hasil Perhitungan Profil</h3>
           <div class="grid grid-cols-2 md:grid-cols-4 gap-4 mb-6">
            <div class="bg-blue-50 border border-blue-200 rounded-lg p-4 text-center">
             <h5 class="font-semibold text-blue-800 mb-1">Total Jarak</h5>
             <p id="profile-total-distance" class="text-lg font-bold text-blue-600">0.00 m</p>
            </div>
            <div class="bg-green-50 border border-green-200 rounded-lg p-4 text-center">
             <h5 class="font-semibold text-green-800 mb-1">Kemiringan Rata-rata</h5>
             <p id="profile-avg-slope" class="text-lg font-bold text-green-600">0.00%</p>
            </div>
            <div class="bg-purple-50 border border-purple-200 rounded-lg p-4 text-center">
             <h5 class="font-semibold text-purple-800 mb-1">Elevasi Tertinggi</h5>
             <p id="profile-max-elevation" class="text-lg font-bold text-purple-600">0.00 m</p>
            </div>
            <div class="bg-orange-50 border border-orange-200 rounded-lg p-4 text-center">
             <h5 class="font-semibold text-orange-800 mb-1">Elevasi Terendah</h5>
             <p id="profile-min-elevation" class="text-lg font-bold text-orange-600">0.00 m</p>
            </div>
           </div>
           <div class="overflow-x-auto">
            <table class="w-full border-collapse border border-gray-300 rounded-lg">
             <thead class="bg-blue-50">
              <tr>
               <th class="border border-gray-300 px-4 py-2 text-left">Nama</th>
               <th class="border border-gray-300 px-4 py-2 text-right">Jarak (m)</th>
               <th class="border border-gray-300 px-4 py-2 text-right">Elevasi (m)</th>
               <th class="border border-gray-300 px-4 py-2 text-right">Kemiringan (%)</th>
               <th class="border border-gray-300 px-4 py-2 text-center">Aksi</th>
              </tr>
             </thead>
             <tbody id="profile-table-body">
              <tr>
               <td colspan="5" class="border border-gray-300 px-4 py-8 text-center text-gray-500">Belum ada data profil</td>
              </tr>
             </tbody>
            </table>
           </div>
           <div class="mt-6">
            <h4 class="font-semibold text-gray-700 mb-3">Grafik Profil</h4>
            <div id="profile-chart" class="border border-gray-300 rounded-lg bg-gray-50 h-64 flex items-center justify-center">
             <p class="text-gray-500">Tambahkan titik profil untuk melihat grafik</p>
            </div>
           </div>
          </div>
         </div>
        </div><!-- Random Points Module -->
        <div id="random-calc" class="surveyor-content hidden">
         <div class="grid grid-cols-1 xl:grid-cols-3 gap-8"><!-- Input Section -->
          <div class="xl:col-span-1">
           <h3 class="text-xl font-bold text-gray-900 mb-6">Input Titik Acak</h3>
           <div class="space-y-4 mb-6">
            <div class="grid grid-cols-4 gap-2"><input type="text" placeholder="Nama" class="p-3 border border-gray-300 rounded-lg random-name"> <input type="number" placeholder="X (m)" step="0.001" class="p-3 border border-gray-300 rounded-lg random-x"> <input type="number" placeholder="Y (m)" step="0.001" class="p-3 border border-gray-300 rounded-lg random-y"> <input type="number" placeholder="Z (m)" step="0.001" class="p-3 border border-gray-300 rounded-lg random-z">
            </div><button onclick="addRandomPoint()" class="w-full btn-gradient text-white px-4 py-2 rounded-lg font-semibold">Tambah Titik Acak</button>
           </div>
           <div class="space-y-3"><button onclick="calculateRandom()" class="w-full bg-blue-600 hover:bg-blue-700 text-white px-4 py-3 rounded-lg font-semibold">Analisis Titik Acak</button> <button onclick="loadSampleData('random')" class="w-full bg-gray-600 hover:bg-gray-700 text-white px-4 py-2 rounded-lg font-semibold">üìã Load Data Contoh</button> <button onclick="clearData('random')" class="w-full bg-red-600 hover:bg-red-700 text-white px-4 py-2 rounded-lg font-semibold">üóëÔ∏è Clear Data</button> <button onclick="exportData('random', 'csv')" class="w-full bg-green-600 hover:bg-green-700 text-white px-4 py-2 rounded-lg font-semibold">Ekspor CSV</button>
           </div>
          </div><!-- Results Section -->
          <div class="xl:col-span-2">
           <h3 class="text-xl font-bold text-gray-900 mb-6">Hasil Analisis Titik Acak</h3>
           <div class="grid grid-cols-2 md:grid-cols-3 gap-4 mb-6">
            <div class="bg-blue-50 border border-blue-200 rounded-lg p-4 text-center">
             <h5 class="font-semibold text-blue-800 mb-1">Total Titik</h5>
             <p id="random-count" class="text-lg font-bold text-blue-600">0</p>
            </div>
            <div class="bg-green-50 border border-green-200 rounded-lg p-4 text-center">
             <h5 class="font-semibold text-green-800 mb-1">Jarak Rata-rata</h5>
             <p id="random-avg-distance" class="text-lg font-bold text-green-600">0.00 m</p>
            </div>
            <div class="bg-purple-50 border border-purple-200 rounded-lg p-4 text-center">
             <h5 class="font-semibold text-purple-800 mb-1">Sebaran Area</h5>
             <p id="random-area" class="text-lg font-bold text-purple-600">0.00 m¬≤</p>
            </div>
           </div>
           <div class="overflow-x-auto">
            <table class="w-full border-collapse border border-gray-300 rounded-lg">
             <thead class="bg-blue-50">
              <tr>
               <th class="border border-gray-300 px-4 py-2 text-left">Nama</th>
               <th class="border border-gray-300 px-4 py-2 text-right">X (m)</th>
               <th class="border border-gray-300 px-4 py-2 text-right">Y (m)</th>
               <th class="border border-gray-300 px-4 py-2 text-right">Z (m)</th>
               <th class="border border-gray-300 px-4 py-2 text-right">Jarak ke Pusat (m)</th>
               <th class="border border-gray-300 px-4 py-2 text-center">Aksi</th>
              </tr>
             </thead>
             <tbody id="random-table-body">
              <tr>
               <td colspan="6" class="border border-gray-300 px-4 py-8 text-center text-gray-500">Belum ada titik acak</td>
              </tr>
             </tbody>
            </table>
           </div>
           <div class="mt-6">
            <h4 class="font-semibold text-gray-700 mb-3">Sebaran Titik Acak</h4>
            <div id="random-preview" class="border border-gray-300 rounded-lg bg-gray-50 h-64 flex items-center justify-center">
             <p class="text-gray-500">Tambahkan titik acak untuk melihat sebaran</p>
            </div>
           </div>
          </div>
         </div>
        </div>
       </div>
      </div>
     </section>
    </div>
   </div>
  </div>
  <script>
        // Default configuration
        const defaultConfig = {
            brand_name: "MinaMetrics",
            hero_tagline: "Teknologi Survey Terdepan",
            hero_title: "Solusi Survey Profesional untuk Masa Depan",
            hero_description: "Dengan teknologi terdepan dan tim berpengalaman, kami memberikan layanan survey topografi, pemetaan GPS, dan analisis kontur yang akurat untuk proyek konstruksi dan infrastruktur Anda.",
            ceo_name: "Tika Nur Aminah, S.T.",
            ceo_title: "CEO & Founder"
        };

        // Element SDK initialization
        async function onConfigChange(config) {
            // Update brand name
            const brandElement = document.getElementById('brand-name');
            if (brandElement) {
                brandElement.textContent = config.brand_name || defaultConfig.brand_name;
            }

            // Update hero tagline
            const taglineElement = document.getElementById('hero-tagline');
            if (taglineElement) {
                taglineElement.textContent = config.hero_tagline || defaultConfig.hero_tagline;
            }

            // Update hero title
            const titleElement = document.getElementById('hero-title');
            if (titleElement) {
                titleElement.textContent = config.hero_title || defaultConfig.hero_title;
            }

            // Update hero description
            const descElement = document.getElementById('hero-description');
            if (descElement) {
                descElement.textContent = config.hero_description || defaultConfig.hero_description;
            }

            // Update CEO name
            const ceoNameElement = document.getElementById('ceo-name');
            if (ceoNameElement) {
                ceoNameElement.textContent = config.ceo_name || defaultConfig.ceo_name;
            }

            // Update CEO title
            const ceoTitleElement = document.getElementById('ceo-title');
            if (ceoTitleElement) {
                ceoTitleElement.textContent = config.ceo_title || defaultConfig.ceo_title;
            }
        }

        function mapToCapabilities(config) {
            return {
                recolorables: [],
                borderables: [],
                fontEditable: undefined,
                fontSizeable: undefined
            };
        }

        function mapToEditPanelValues(config) {
            return new Map([
                ["brand_name", config.brand_name || defaultConfig.brand_name],
                ["hero_tagline", config.hero_tagline || defaultConfig.hero_tagline],
                ["hero_title", config.hero_title || defaultConfig.hero_title],
                ["hero_description", config.hero_description || defaultConfig.hero_description],
                ["ceo_name", config.ceo_name || defaultConfig.ceo_name],
                ["ceo_title", config.ceo_title || defaultConfig.ceo_title]
            ]);
        }

        // Initialize Element SDK
        if (window.elementSdk) {
            window.elementSdk.init({
                defaultConfig,
                onConfigChange,
                mapToCapabilities,
                mapToEditPanelValues
            });
        }

        // Mobile menu toggle
        document.getElementById('mobile-menu-btn').addEventListener('click', function() {
            const mobileMenu = document.getElementById('mobile-menu');
            mobileMenu.classList.toggle('active');
        });

        // Page navigation system
        let currentPage = 'home';

        function navigateToPage(pageName) {
            // Hide all pages
            document.querySelectorAll('.page-content').forEach(page => {
                page.classList.add('hidden');
            });
            
            // Show selected page
            const targetPage = document.getElementById(pageName + '-page');
            if (targetPage) {
                targetPage.classList.remove('hidden');
                currentPage = pageName;
                
                // Close mobile menu if open
                document.getElementById('mobile-menu').classList.remove('active');
                
                // Scroll to top
                window.scrollTo({ top: 0, behavior: 'smooth' });
            }
        }

        // SISTEM POLIGON BARU - SESUAI KETENTUAN KLIEN
        let polygonMainPoints = []; // Titik utama (A, B, C...) dengan X,Y saja
        let polygonSubPoints = [];  // Titik turunan (A1, A2, B1...) dengan Z

        // Data untuk modul lainnya
        let gridPoints = [];
        let profilePoints = [];
        let randomPoints = [];

        // Sample data sesuai ketentuan klien
        const sampleData = {
            polygonMain: [
                { name: 'A', x: 100.000, y: 200.000 },
                { name: 'B', x: 150.000, y: 200.000 },
                { name: 'C', x: 150.000, y: 250.000 },
                { name: 'D', x: 120.000, y: 270.000 },
                { name: 'E', x: 100.000, y: 250.000 }
            ],
            polygonSub: [
                { name: 'A1', mainPoint: 'A', z: 105.5 },
                { name: 'A2', mainPoint: 'A', z: 105.8 },
                { name: 'B1', mainPoint: 'B', z: 106.2 },
                { name: 'C1', mainPoint: 'C', z: 107.1 },
                { name: 'C2', mainPoint: 'C', z: 107.3 },
                { name: 'D1', mainPoint: 'D', z: 108.0 },
                { name: 'E1', mainPoint: 'E', z: 106.8 }
            ],
            grid: [
                { name: 'G1', x: 100, y: 100, z: 105.2 },
                { name: 'G2', x: 110, y: 100, z: 105.8 },
                { name: 'G3', x: 120, y: 100, z: 106.1 },
                { name: 'G4', x: 100, y: 110, z: 105.5 },
                { name: 'G5', x: 110, y: 110, z: 106.0 },
                { name: 'G6', x: 120, y: 110, z: 106.3 }
            ],
            profile: [
                { name: 'P1', distance: 0, elevation: 105.0 },
                { name: 'P2', distance: 25, elevation: 106.2 },
                { name: 'P3', distance: 50, elevation: 107.8 },
                { name: 'P4', distance: 75, elevation: 108.5 },
                { name: 'P5', distance: 100, elevation: 109.1 }
            ],
            random: [
                { name: 'R1', x: 95, y: 205, z: 105.3 },
                { name: 'R2', x: 132, y: 187, z: 106.7 },
                { name: 'R3', x: 168, y: 234, z: 107.2 },
                { name: 'R4', x: 143, y: 276, z: 108.1 },
                { name: 'R5', x: 89, y: 251, z: 106.9 }
            ]
        };

        // Surveyor tab functionality
        document.querySelectorAll('.surveyor-tab').forEach(tab => {
            tab.addEventListener('click', function() {
                // Remove active class from all tabs
                document.querySelectorAll('.surveyor-tab').forEach(t => t.classList.remove('active'));
                // Add active class to clicked tab
                this.classList.add('active');
                
                // Hide all surveyor contents
                document.querySelectorAll('.surveyor-content').forEach(content => {
                    content.classList.add('hidden');
                });
                
                // Show selected surveyor content
                const targetId = this.getAttribute('data-tab') + '-calc';
                document.getElementById(targetId).classList.remove('hidden');
            });
        });

        // FUNGSI POLYGON TAB SWITCHING
        function switchPolygonTab(tabType) {
            const mainTab = document.getElementById('main-point-tab');
            const subTab = document.getElementById('sub-point-tab');
            const mainInput = document.getElementById('main-point-input');
            const subInput = document.getElementById('sub-point-input');

            if (tabType === 'main') {
                mainTab.classList.add('active');
                subTab.classList.remove('active');
                mainInput.classList.remove('hidden');
                subInput.classList.add('hidden');
            } else {
                mainTab.classList.remove('active');
                subTab.classList.add('active');
                mainInput.classList.add('hidden');
                subInput.classList.remove('hidden');
                updateSubPointDropdown();
            }
        }

        // FUNGSI TAMBAH TITIK UTAMA (A, B, C... dengan X,Y saja)
        function addMainPoint() {
            const name = document.querySelector('.polygon-main-name').value.toUpperCase().trim();
            const x = parseFloat(document.querySelector('.polygon-main-x').value);
            const y = parseFloat(document.querySelector('.polygon-main-y').value);

            // Validasi input
            if (!name || !/^[A-Z]$/.test(name)) {
                showMessage('Nama titik utama harus huruf besar tunggal (A, B, C...)', 'error');
                return;
            }

            if (isNaN(x) || isNaN(y)) {
                showMessage('Koordinat X dan Y harus diisi dengan angka', 'error');
                return;
            }

            // Cek duplikasi nama
            if (polygonMainPoints.find(p => p.name === name)) {
                showMessage(`Titik utama ${name} sudah ada`, 'error');
                return;
            }

            polygonMainPoints.push({ name, x, y });
            
            // Clear inputs
            document.querySelector('.polygon-main-name').value = '';
            document.querySelector('.polygon-main-x').value = '';
            document.querySelector('.polygon-main-y').value = '';

            updateMainPointTable();
            updateSubPointDropdown();
            showMessage(`Titik utama ${name} berhasil ditambahkan`, 'success');
        }

        // FUNGSI TAMBAH TITIK TURUNAN (A1, A2... dengan Z)
        function addSubPoint() {
            const mainPoint = document.querySelector('.polygon-sub-main').value;
            const name = document.querySelector('.polygon-sub-name').value.trim();
            const z = parseFloat(document.querySelector('.polygon-sub-z').value);

            // Validasi input
            if (!mainPoint) {
                showMessage('Pilih titik utama terlebih dahulu', 'error');
                return;
            }

            if (!name || !/^[A-Z]\d+$/.test(name)) {
                showMessage('Nama titik turunan harus format A1, A2, B1... (huruf besar + angka)', 'error');
                return;
            }

            if (!name.startsWith(mainPoint)) {
                showMessage(`Nama titik turunan harus dimulai dengan ${mainPoint} (contoh: ${mainPoint}1, ${mainPoint}2...)`, 'error');
                return;
            }

            if (isNaN(z)) {
                showMessage('Elevasi Z harus diisi dengan angka', 'error');
                return;
            }

            // Cek duplikasi nama
            if (polygonSubPoints.find(p => p.name === name)) {
                showMessage(`Titik turunan ${name} sudah ada`, 'error');
                return;
            }

            polygonSubPoints.push({ name, mainPoint, z });
            
            // Clear inputs
            document.querySelector('.polygon-sub-name').value = '';
            document.querySelector('.polygon-sub-z').value = '';

            updateSubPointTable();
            showMessage(`Titik turunan ${name} berhasil ditambahkan`, 'success');
        }

        // UPDATE DROPDOWN TITIK UTAMA
        function updateSubPointDropdown() {
            const dropdown = document.querySelector('.polygon-sub-main');
            dropdown.innerHTML = '<option value="">Pilih Titik Utama</option>';
            
            polygonMainPoints.forEach(point => {
                dropdown.innerHTML += `<option value="${point.name}">${point.name} (${point.x}, ${point.y})</option>`;
            });
        }

        // HITUNG POLIGON - Azimuth & Jarak dari titik utama, Elevasi dari titik turunan
        function calculatePolygon() {
            if (polygonMainPoints.length < 3) {
                showMessage('Minimal 3 titik utama diperlukan untuk membuat poligon', 'error');
                return;
            }

            let perimeter = 0;
            let area = 0;

            // Calculate area using shoelace formula (dari titik utama)
            for (let i = 0; i < polygonMainPoints.length; i++) {
                const j = (i + 1) % polygonMainPoints.length;
                area += polygonMainPoints[i].x * polygonMainPoints[j].y;
                area -= polygonMainPoints[j].x * polygonMainPoints[i].y;
            }
            area = Math.abs(area) / 2;

            // Calculate perimeter, azimuth, dan jarak (dari titik utama)
            for (let i = 0; i < polygonMainPoints.length; i++) {
                const j = (i + 1) % polygonMainPoints.length;
                const dx = polygonMainPoints[j].x - polygonMainPoints[i].x;
                const dy = polygonMainPoints[j].y - polygonMainPoints[i].y;
                const distance = Math.sqrt(dx * dx + dy * dy);
                perimeter += distance;

                // Calculate azimuth
                let azimuth = Math.atan2(dx, dy) * 180 / Math.PI;
                if (azimuth < 0) azimuth += 360;

                polygonMainPoints[i].azimuth = azimuth;
                polygonMainPoints[i].distance = distance;
            }

            // Calculate kemiringan untuk titik turunan
            calculateSubPointSlopes();

            // Update summary
            document.getElementById('polygon-perimeter').textContent = perimeter.toFixed(2) + ' m';
            document.getElementById('polygon-area').textContent = area.toFixed(2) + ' m¬≤';
            document.getElementById('polygon-main-count').textContent = polygonMainPoints.length;
            document.getElementById('polygon-sub-count').textContent = polygonSubPoints.length;

            updateMainPointTable();
            updateSubPointTable();
            drawPolygonPreview();
            showMessage('Perhitungan poligon berhasil!', 'success');
        }

        // HITUNG KEMIRINGAN TITIK TURUNAN
        function calculateSubPointSlopes() {
            polygonSubPoints.forEach(subPoint => {
                // Cari titik turunan lain pada titik utama yang sama untuk menghitung kemiringan
                const sameMainPoints = polygonSubPoints.filter(p => p.mainPoint === subPoint.mainPoint);
                if (sameMainPoints.length > 1) {
                    // Hitung kemiringan rata-rata jika ada multiple elevasi
                    const elevations = sameMainPoints.map(p => p.z);
                    const maxZ = Math.max(...elevations);
                    const minZ = Math.min(...elevations);
                    subPoint.slope = sameMainPoints.length > 1 ? ((maxZ - minZ) / 1) * 100 : 0; // Asumsi jarak horizontal 1m
                } else {
                    subPoint.slope = 0;
                }
            });
        }

        // UPDATE TABEL TITIK UTAMA
        function updateMainPointTable() {
            const tbody = document.getElementById('polygon-main-table-body');
            if (polygonMainPoints.length === 0) {
                tbody.innerHTML = '<tr><td colspan="6" class="border border-gray-300 px-4 py-8 text-center text-gray-500">Belum ada titik utama</td></tr>';
                return;
            }

            tbody.innerHTML = polygonMainPoints.map((point, index) => `
                <tr>
                    <td class="border border-gray-300 px-4 py-2 font-bold">${point.name}</td>
                    <td class="border border-gray-300 px-4 py-2 text-right">${point.x.toFixed(3)}</td>
                    <td class="border border-gray-300 px-4 py-2 text-right">${point.y.toFixed(3)}</td>
                    <td class="border border-gray-300 px-4 py-2 text-right">${point.azimuth ? point.azimuth.toFixed(2) + '¬∞' : '-'}</td>
                    <td class="border border-gray-300 px-4 py-2 text-right">${point.distance ? point.distance.toFixed(3) + ' m' : '-'}</td>
                    <td class="border border-gray-300 px-4 py-2 text-center">
                        <button onclick="removeMainPoint(${index})" class="text-red-500 hover:text-red-700">Hapus</button>
                    </td>
                </tr>
            `).join('');
        }

        // UPDATE TABEL TITIK TURUNAN
        function updateSubPointTable() {
            const tbody = document.getElementById('polygon-sub-table-body');
            if (polygonSubPoints.length === 0) {
                tbody.innerHTML = '<tr><td colspan="7" class="border border-gray-300 px-4 py-8 text-center text-gray-500">Belum ada titik turunan</td></tr>';
                return;
            }

            tbody.innerHTML = polygonSubPoints.map((point, index) => {
                const mainPoint = polygonMainPoints.find(p => p.name === point.mainPoint);
                return `
                <tr>
                    <td class="border border-gray-300 px-4 py-2 font-bold">${point.name}</td>
                    <td class="border border-gray-300 px-4 py-2">${point.mainPoint}</td>
                    <td class="border border-gray-300 px-4 py-2 text-right">${mainPoint ? mainPoint.x.toFixed(3) : '-'}</td>
                    <td class="border border-gray-300 px-4 py-2 text-right">${mainPoint ? mainPoint.y.toFixed(3) : '-'}</td>
                    <td class="border border-gray-300 px-4 py-2 text-right">${point.z.toFixed(3)}</td>
                    <td class="border border-gray-300 px-4 py-2 text-right">${point.slope ? point.slope.toFixed(2) + '%' : '-'}</td>
                    <td class="border border-gray-300 px-4 py-2 text-center">
                        <button onclick="removeSubPoint(${index})" class="text-red-500 hover:text-red-700">Hapus</button>
                    </td>
                </tr>
            `;}).join('');
        }

        // HAPUS TITIK UTAMA
        function removeMainPoint(index) {
            const removedPoint = polygonMainPoints[index];
            polygonMainPoints.splice(index, 1);
            
            // Hapus semua titik turunan yang terkait
            polygonSubPoints = polygonSubPoints.filter(p => p.mainPoint !== removedPoint.name);
            
            updateMainPointTable();
            updateSubPointTable();
            updateSubPointDropdown();
            
            if (polygonMainPoints.length >= 3) {
                calculatePolygon();
            }
            showMessage(`Titik utama ${removedPoint.name} dan titik turunannya berhasil dihapus`, 'success');
        }

        // HAPUS TITIK TURUNAN
        function removeSubPoint(index) {
            const removedPoint = polygonSubPoints[index];
            polygonSubPoints.splice(index, 1);
            updateSubPointTable();
            showMessage(`Titik turunan ${removedPoint.name} berhasil dihapus`, 'success');
        }

        // DRAW POLYGON PREVIEW
        
// DRAW POLYGON PREVIEW (UPGRADED: curved segments, per-segment colors, labels for main & sub points)
function drawPolygonPreview() {
    const preview = document.getElementById('polygon-preview');
    if (!preview) return;
    if (polygonMainPoints.length < 3) {
        preview.innerHTML = '<p class="text-gray-500">Tambahkan minimal 3 titik utama untuk melihat preview</p>';
        return;
    }

    // Compute bounds & scale
    const xs = polygonMainPoints.map(p => p.x);
    const ys = polygonMainPoints.map(p => p.y);
    const minX = Math.min(...xs);
    const maxX = Math.max(...xs);
    const minY = Math.min(...ys);
    const maxY = Math.max(...ys);

    const width = 400;
    const height = 250;
    const padding = 20;

    const scaleX = (width - 2 * padding) / (maxX - minX || 1);
    const scaleY = (height - 2 * padding) / (maxY - minY || 1);
    const scale = Math.min(scaleX, scaleY);

    function toSvgPos(p) {
        const x = padding + (p.x - minX) * scale;
        const y = height - padding - (p.y - minY) * scale;
        return { x, y };
    }

    const svgPoints = polygonMainPoints.map(p => {
        const pos = toSvgPos(p);
        return { name: p.name, x: pos.x, y: pos.y, rawX: p.x, rawY: p.y };
    });

    const colors = ['#3b82f6', '#0ea5e9', '#10b981', '#f59e0b', '#ef4444', '#8b5cf6'];
    const lightShadow = 'rgba(15,23,42,0.06)';

    // Build curved segment paths (quadratic Bezier)
    const segmentPaths = [];
    for (let i = 0; i < svgPoints.length; i++) {
        const a = svgPoints[i];
        const b = svgPoints[(i + 1) % svgPoints.length];

        const mx = (a.x + b.x) / 2;
        const my = (a.y + b.y) / 2;
        const dx = b.x - a.x;
        const dy = b.y - a.y;
        const dist = Math.sqrt(dx * dx + dy * dy) || 1;

        // perpendicular normal
        const nx = -dy / dist;
        const ny = dx / dist;
        const curvature = Math.min(40, Math.max(8, dist * 0.12));
        const sign = (i % 2 === 0) ? 1 : -1;
        const cpx = mx + nx * curvature * sign;
        const cpy = my + ny * curvature * sign;

        const d = `M ${a.x} ${a.y} Q ${cpx} ${cpy} ${b.x} ${b.y}`;
        const color = colors[i % colors.length];
        segmentPaths.push({ d, color, stroke: color, strokeWidth: 3 });
    }

    // Build SVG
    const areaPoly = svgPoints.map(p => `${p.x},${p.y}`).join(' ');

    const subPointsHtml = polygonSubPoints.map((sp, idx) => {
        const main = svgPoints.find(m => m.name === sp.mainPoint);
        if (!main) return '';
        const angle = ((idx * 37) % 360) * Math.PI / 180;
        const offsetR = 18 + (idx % 3) * 6;
        const sx = main.x + Math.cos(angle) * offsetR;
        const sy = main.y - Math.sin(angle) * offsetR;
        // Use small labels and connector lines
        return `
            <g data-sub="${sp.name}">
                <line x1="${main.x}" y1="${main.y}" x2="${sx}" y2="${sy}" stroke="#94a3b8" stroke-width="1" stroke-dasharray="3,3" />
                <circle cx="${sx}" cy="${sy}" r="4" fill="#10b981" stroke="#fff" stroke-width="1" />
                <text x="${sx + 6}" y="${sy + 4}" font-size="10" font-weight="600" fill="#065f46">${sp.name}: ${sp.z.toFixed(3)}m</text>
            </g>
        `;
    }).join('');

    const mainPointsHtml = svgPoints.map(p => `
        <g data-main="${p.name}">
            <circle cx="${p.x}" cy="${p.y}" r="6" fill="#fff" stroke="#111827" stroke-width="1.5" />
            <circle cx="${p.x}" cy="${p.y}" r="4" fill="#ef4444" />
            <text x="${p.x + 10}" y="${p.y - 10}" font-size="12" font-weight="700" fill="#111827">${p.name}</text>
            <text x="${p.x + 10}" y="${p.y + 6}" font-size="11" fill="#6b7280">(${p.rawX.toFixed(3)}, ${p.rawY.toFixed(3)})</text>
        </g>
    `).join('');

    // Render SVG content (paths first, shadows behind)
    const segPathsHtml = segmentPaths.map(sp => `
        <path d="${sp.d}" fill="none" stroke="${lightShadow}" stroke-width="${sp.strokeWidth+2}" stroke-linecap="round" stroke-linejoin="round" opacity="0.6"/>
        <path d="${sp.d}" fill="none" stroke="${sp.stroke}" stroke-width="${sp.strokeWidth}" stroke-linecap="round" stroke-linejoin="round" opacity="0.95"/>
    `).join('');

    preview.innerHTML = `
        <svg width="100%" height="100%" viewBox="0 0 ${width} ${height}" xmlns="http://www.w3.org/2000/svg" class="border rounded">
            <polygon points="${areaPoly}" fill="rgba(59,130,246,0.06)" stroke="none" />
            ${segPathsHtml}
            ${mainPointsHtml}
            ${subPointsHtml}
        </svg>
    `;
}


        // FUNGSI GRID MODULE
        function addGridPoint() {
            const name = document.querySelector('.grid-name').value.trim();
            const x = parseFloat(document.querySelector('.grid-x').value);
            const y = parseFloat(document.querySelector('.grid-y').value);
            const z = parseFloat(document.querySelector('.grid-z').value);

            if (!name || isNaN(x) || isNaN(y) || isNaN(z)) {
                showMessage('Semua field harus diisi dengan benar', 'error');
                return;
            }

            if (gridPoints.find(p => p.name === name)) {
                showMessage(`Titik ${name} sudah ada`, 'error');
                return;
            }

            gridPoints.push({ name, x, y, z });
            
            // Clear inputs
            document.querySelector('.grid-name').value = '';
            document.querySelector('.grid-x').value = '';
            document.querySelector('.grid-y').value = '';
            document.querySelector('.grid-z').value = '';

            updateGridTable();
            showMessage(`Titik grid ${name} berhasil ditambahkan`, 'success');
        }

        function calculateGrid() {
            if (gridPoints.length === 0) {
                showMessage('Belum ada data grid untuk dihitung', 'error');
                return;
            }

            const elevations = gridPoints.map(p => p.z);
            const avgElevation = elevations.reduce((a, b) => a + b, 0) / elevations.length;
            const minElevation = Math.min(...elevations);
            const maxElevation = Math.max(...elevations);
            const elevationRange = maxElevation - minElevation;

            document.getElementById('grid-count').textContent = gridPoints.length;
            document.getElementById('grid-avg-elevation').textContent = avgElevation.toFixed(2) + ' m';
            document.getElementById('grid-elevation-range').textContent = elevationRange.toFixed(2) + ' m';

            updateGridTable();
            drawGridPreview();
            showMessage('Perhitungan grid berhasil!', 'success');
        }

        function updateGridTable() {
            const tbody = document.getElementById('grid-table-body');
            if (gridPoints.length === 0) {
                tbody.innerHTML = '<tr><td colspan="5" class="border border-gray-300 px-4 py-8 text-center text-gray-500">Belum ada data grid</td></tr>';
                return;
            }

            tbody.innerHTML = gridPoints.map((point, index) => `
                <tr>
                    <td class="border border-gray-300 px-4 py-2 font-bold">${point.name}</td>
                    <td class="border border-gray-300 px-4 py-2 text-right">${point.x.toFixed(3)}</td>
                    <td class="border border-gray-300 px-4 py-2 text-right">${point.y.toFixed(3)}</td>
                    <td class="border border-gray-300 px-4 py-2 text-right">${point.z.toFixed(3)}</td>
                    <td class="border border-gray-300 px-4 py-2 text-center">
                        <button onclick="removeGridPoint(${index})" class="text-red-500 hover:text-red-700">Hapus</button>
                    </td>
                </tr>
            `).join('');
        }

        function removeGridPoint(index) {
            const removedPoint = gridPoints[index];
            gridPoints.splice(index, 1);
            updateGridTable();
            if (gridPoints.length > 0) calculateGrid();
            showMessage(`Titik grid ${removedPoint.name} berhasil dihapus`, 'success');
        }

        function drawGridPreview() {
            const preview = document.getElementById('grid-preview');
            if (gridPoints.length === 0) {
                preview.innerHTML = '<p class="text-gray-500">Tambahkan titik grid untuk melihat preview</p>';
                return;
            }

            const minX = Math.min(...gridPoints.map(p => p.x));
            const maxX = Math.max(...gridPoints.map(p => p.x));
            const minY = Math.min(...gridPoints.map(p => p.y));
            const maxY = Math.max(...gridPoints.map(p => p.y));
            
            const width = 400;
            const height = 250;
            const padding = 20;
            
            const scaleX = (width - 2 * padding) / (maxX - minX || 1);
            const scaleY = (height - 2 * padding) / (maxY - minY || 1);
            const scale = Math.min(scaleX, scaleY);

            preview.innerHTML = `
                <svg width="100%" height="100%" viewBox="0 0 ${width} ${height}" class="border rounded">
                    ${gridPoints.map(p => {
                        const x = padding + (p.x - minX) * scale;
                        const y = height - padding - (p.y - minY) * scale;
                        return `<circle cx="${x}" cy="${y}" r="4" fill="#3b82f6"/>
                                <text x="${x + 8}" y="${y - 8}" font-size="10" font-weight="bold" fill="#374151">${p.name}</text>
                                <text x="${x + 8}" y="${y + 5}" font-size="8" fill="#6b7280">Z:${p.z.toFixed(1)}</text>`;
                    }).join('')}
                </svg>
            `;
        }

        // FUNGSI PROFILE MODULE
        function addProfilePoint() {
            const name = document.querySelector('.profile-name').value.trim();
            const distance = parseFloat(document.querySelector('.profile-distance').value);
            const elevation = parseFloat(document.querySelector('.profile-elevation').value);

            if (!name || isNaN(distance) || isNaN(elevation)) {
                showMessage('Semua field harus diisi dengan benar', 'error');
                return;
            }

            if (profilePoints.find(p => p.name === name)) {
                showMessage(`Titik ${name} sudah ada`, 'error');
                return;
            }

            profilePoints.push({ name, distance, elevation });
            profilePoints.sort((a, b) => a.distance - b.distance); // Sort by distance
            
            // Clear inputs
            document.querySelector('.profile-name').value = '';
            document.querySelector('.profile-distance').value = '';
            document.querySelector('.profile-elevation').value = '';

            updateProfileTable();
            showMessage(`Titik profil ${name} berhasil ditambahkan`, 'success');
        }

        function calculateProfile() {
            if (profilePoints.length === 0) {
                showMessage('Belum ada data profil untuk dihitung', 'error');
                return;
            }

            const totalDistance = Math.max(...profilePoints.map(p => p.distance));
            const elevations = profilePoints.map(p => p.elevation);
            const minElevation = Math.min(...elevations);
            const maxElevation = Math.max(...elevations);

            // Calculate slopes
            for (let i = 0; i < profilePoints.length; i++) {
                if (i > 0) {
                    const prevPoint = profilePoints[i - 1];
                    const currPoint = profilePoints[i];
                    const deltaH = currPoint.elevation - prevPoint.elevation;
                    const deltaD = currPoint.distance - prevPoint.distance;
                    currPoint.slope = deltaD > 0 ? (deltaH / deltaD) * 100 : 0;
                } else {
                    profilePoints[i].slope = 0;
                }
            }

            const avgSlope = profilePoints.length > 1 ? 
                profilePoints.slice(1).reduce((sum, p) => sum + p.slope, 0) / (profilePoints.length - 1) : 0;

            document.getElementById('profile-total-distance').textContent = totalDistance.toFixed(2) + ' m';
            document.getElementById('profile-avg-slope').textContent = avgSlope.toFixed(2) + '%';
            document.getElementById('profile-max-elevation').textContent = maxElevation.toFixed(2) + ' m';
            document.getElementById('profile-min-elevation').textContent = minElevation.toFixed(2) + ' m';

            updateProfileTable();
            drawProfileChart();
            showMessage('Perhitungan profil berhasil!', 'success');
        }

        function updateProfileTable() {
            const tbody = document.getElementById('profile-table-body');
            if (profilePoints.length === 0) {
                tbody.innerHTML = '<tr><td colspan="5" class="border border-gray-300 px-4 py-8 text-center text-gray-500">Belum ada data profil</td></tr>';
                return;
            }

            tbody.innerHTML = profilePoints.map((point, index) => `
                <tr>
                    <td class="border border-gray-300 px-4 py-2 font-bold">${point.name}</td>
                    <td class="border border-gray-300 px-4 py-2 text-right">${point.distance.toFixed(3)}</td>
                    <td class="border border-gray-300 px-4 py-2 text-right">${point.elevation.toFixed(3)}</td>
                    <td class="border border-gray-300 px-4 py-2 text-right">${point.slope ? point.slope.toFixed(2) + '%' : '-'}</td>
                    <td class="border border-gray-300 px-4 py-2 text-center">
                        <button onclick="removeProfilePoint(${index})" class="text-red-500 hover:text-red-700">Hapus</button>
                    </td>
                </tr>
            `).join('');
        }

        function removeProfilePoint(index) {
            const removedPoint = profilePoints[index];
            profilePoints.splice(index, 1);
            updateProfileTable();
            if (profilePoints.length > 0) calculateProfile();
            showMessage(`Titik profil ${removedPoint.name} berhasil dihapus`, 'success');
        }

        function drawProfileChart() {
            const chart = document.getElementById('profile-chart');
            if (profilePoints.length === 0) {
                chart.innerHTML = '<p class="text-gray-500">Tambahkan titik profil untuk melihat grafik</p>';
                return;
            }

            const width = 400;
            const height = 250;
            const padding = 40;
            
            const maxDistance = Math.max(...profilePoints.map(p => p.distance));
            const minElevation = Math.min(...profilePoints.map(p => p.elevation));
            const maxElevation = Math.max(...profilePoints.map(p => p.elevation));
            
            const scaleX = (width - 2 * padding) / (maxDistance || 1);
            const scaleY = (height - 2 * padding) / (maxElevation - minElevation || 1);

            const pathData = profilePoints.map((p, i) => {
                const x = padding + p.distance * scaleX;
                const y = height - padding - (p.elevation - minElevation) * scaleY;
                return `${i === 0 ? 'M' : 'L'} ${x} ${y}`;
            }).join(' ');

            chart.innerHTML = `
                <svg width="100%" height="100%" viewBox="0 0 ${width} ${height}" class="border rounded">
                    <path d="${pathData}" fill="none" stroke="#3b82f6" stroke-width="2"/>
                    ${profilePoints.map(p => {
                        const x = padding + p.distance * scaleX;
                        const y = height - padding - (p.elevation - minElevation) * scaleY;
                        return `<circle cx="${x}" cy="${y}" r="3" fill="#ef4444"/>
                                <text x="${x}" y="${y - 8}" font-size="8" text-anchor="middle" fill="#374151">${p.name}</text>`;
                    }).join('')}
                    <text x="${width/2}" y="${height - 5}" font-size="10" text-anchor="middle" fill="#6b7280">Jarak (m)</text>
                    <text x="15" y="${height/2}" font-size="10" text-anchor="middle" fill="#6b7280" transform="rotate(-90 15 ${height/2})">Elevasi (m)</text>
                </svg>
            `;
        }

        // FUNGSI RANDOM POINTS MODULE
        function addRandomPoint() {
            const name = document.querySelector('.random-name').value.trim();
            const x = parseFloat(document.querySelector('.random-x').value);
            const y = parseFloat(document.querySelector('.random-y').value);
            const z = parseFloat(document.querySelector('.random-z').value);

            if (!name || isNaN(x) || isNaN(y) || isNaN(z)) {
                showMessage('Semua field harus diisi dengan benar', 'error');
                return;
            }

            if (randomPoints.find(p => p.name === name)) {
                showMessage(`Titik ${name} sudah ada`, 'error');
                return;
            }

            randomPoints.push({ name, x, y, z });
            
            // Clear inputs
            document.querySelector('.random-name').value = '';
            document.querySelector('.random-x').value = '';
            document.querySelector('.random-y').value = '';
            document.querySelector('.random-z').value = '';

            updateRandomTable();
            showMessage(`Titik acak ${name} berhasil ditambahkan`, 'success');
        }

        function calculateRandom() {
            if (randomPoints.length === 0) {
                showMessage('Belum ada titik acak untuk dianalisis', 'error');
                return;
            }

            // Calculate centroid
            const centroidX = randomPoints.reduce((sum, p) => sum + p.x, 0) / randomPoints.length;
            const centroidY = randomPoints.reduce((sum, p) => sum + p.y, 0) / randomPoints.length;

            // Calculate distances to centroid
            randomPoints.forEach(point => {
                const dx = point.x - centroidX;
                const dy = point.y - centroidY;
                point.distanceToCenter = Math.sqrt(dx * dx + dy * dy);
            });

            const avgDistance = randomPoints.reduce((sum, p) => sum + p.distanceToCenter, 0) / randomPoints.length;

            // Calculate bounding area
            const minX = Math.min(...randomPoints.map(p => p.x));
            const maxX = Math.max(...randomPoints.map(p => p.x));
            const minY = Math.min(...randomPoints.map(p => p.y));
            const maxY = Math.max(...randomPoints.map(p => p.y));
            const area = (maxX - minX) * (maxY - minY);

            document.getElementById('random-count').textContent = randomPoints.length;
            document.getElementById('random-avg-distance').textContent = avgDistance.toFixed(2) + ' m';
            document.getElementById('random-area').textContent = area.toFixed(2) + ' m¬≤';

            updateRandomTable();
            drawRandomPreview();
            showMessage('Analisis titik acak berhasil!', 'success');
        }

        function updateRandomTable() {
            const tbody = document.getElementById('random-table-body');
            if (randomPoints.length === 0) {
                tbody.innerHTML = '<tr><td colspan="6" class="border border-gray-300 px-4 py-8 text-center text-gray-500">Belum ada titik acak</td></tr>';
                return;
            }

            tbody.innerHTML = randomPoints.map((point, index) => `
                <tr>
                    <td class="border border-gray-300 px-4 py-2 font-bold">${point.name}</td>
                    <td class="border border-gray-300 px-4 py-2 text-right">${point.x.toFixed(3)}</td>
                    <td class="border border-gray-300 px-4 py-2 text-right">${point.y.toFixed(3)}</td>
                    <td class="border border-gray-300 px-4 py-2 text-right">${point.z.toFixed(3)}</td>
                    <td class="border border-gray-300 px-4 py-2 text-right">${point.distanceToCenter ? point.distanceToCenter.toFixed(2) : '-'}</td>
                    <td class="border border-gray-300 px-4 py-2 text-center">
                        <button onclick="removeRandomPoint(${index})" class="text-red-500 hover:text-red-700">Hapus</button>
                    </td>
                </tr>
            `).join('');
        }

        function removeRandomPoint(index) {
            const removedPoint = randomPoints[index];
            randomPoints.splice(index, 1);
            updateRandomTable();
            if (randomPoints.length > 0) calculateRandom();
            showMessage(`Titik acak ${removedPoint.name} berhasil dihapus`, 'success');
        }

        function drawRandomPreview() {
            const preview = document.getElementById('random-preview');
            if (randomPoints.length === 0) {
                preview.innerHTML = '<p class="text-gray-500">Tambahkan titik acak untuk melihat sebaran</p>';
                return;
            }

            const minX = Math.min(...randomPoints.map(p => p.x));
            const maxX = Math.max(...randomPoints.map(p => p.x));
            const minY = Math.min(...randomPoints.map(p => p.y));
            const maxY = Math.max(...randomPoints.map(p => p.y));
            
            const width = 400;
            const height = 250;
            const padding = 20;
            
            const scaleX = (width - 2 * padding) / (maxX - minX || 1);
            const scaleY = (height - 2 * padding) / (maxY - minY || 1);
            const scale = Math.min(scaleX, scaleY);

            // Calculate centroid for display
            const centroidX = randomPoints.reduce((sum, p) => sum + p.x, 0) / randomPoints.length;
            const centroidY = randomPoints.reduce((sum, p) => sum + p.y, 0) / randomPoints.length;
            const centX = padding + (centroidX - minX) * scale;
            const centY = height - padding - (centroidY - minY) * scale;

            preview.innerHTML = `
                <svg width="100%" height="100%" viewBox="0 0 ${width} ${height}" class="border rounded">
                    <!-- Centroid -->
                    <circle cx="${centX}" cy="${centY}" r="6" fill="#ef4444" stroke="#ffffff" stroke-width="2"/>
                    <text x="${centX + 10}" y="${centY - 10}" font-size="10" font-weight="bold" fill="#ef4444">Pusat</text>
                    
                    <!-- Random Points -->
                    ${randomPoints.map(p => {
                        const x = padding + (p.x - minX) * scale;
                        const y = height - padding - (p.y - minY) * scale;
                        return `<circle cx="${x}" cy="${y}" r="4" fill="#3b82f6"/>
                                <line x1="${centX}" y1="${centY}" x2="${x}" y2="${y}" stroke="#94a3b8" stroke-width="1" stroke-dasharray="2,2"/>
                                <text x="${x + 8}" y="${y - 8}" font-size="8" font-weight="bold" fill="#374151">${p.name}</text>`;
                    }).join('')}
                </svg>
            `;
        }

        // LOAD SAMPLE DATA
        function loadSampleData(module) {
            if (module === 'polygon') {
                polygonMainPoints = [...sampleData.polygonMain];
                polygonSubPoints = [...sampleData.polygonSub];
                
                updateMainPointTable();
                updateSubPointTable();
                updateSubPointDropdown();
                calculatePolygon();
                
                showMessage('Data contoh berhasil dimuat! 5 titik utama dan 7 titik turunan siap untuk dihitung.', 'success');
            } else if (module === 'grid') {
                gridPoints = [...sampleData.grid];
                updateGridTable();
                calculateGrid();
                showMessage('Data contoh grid berhasil dimuat! 6 titik grid siap untuk dihitung.', 'success');
            } else if (module === 'profile') {
                profilePoints = [...sampleData.profile];
                updateProfileTable();
                calculateProfile();
                showMessage('Data contoh profil berhasil dimuat! 5 titik profil siap untuk dihitung.', 'success');
            } else if (module === 'random') {
                randomPoints = [...sampleData.random];
                updateRandomTable();
                calculateRandom();
                showMessage('Data contoh titik acak berhasil dimuat! 5 titik acak siap untuk dianalisis.', 'success');
            }
        }

        // CLEAR DATA
        function clearData(module) {
            if (module === 'polygon') {
                polygonMainPoints = [];
                polygonSubPoints = [];
                
                updateMainPointTable();
                updateSubPointTable();
                updateSubPointDropdown();
                
                // Reset stats
                document.getElementById('polygon-perimeter').textContent = '0.00 m';
                document.getElementById('polygon-area').textContent = '0.00 m¬≤';
                document.getElementById('polygon-main-count').textContent = '0';
                document.getElementById('polygon-sub-count').textContent = '0';
                
                // Reset preview
                document.getElementById('polygon-preview').innerHTML = '<p class="text-gray-500">Tambahkan minimal 3 titik utama untuk melihat preview</p>';
                
                showMessage('Semua data poligon berhasil dihapus', 'success');
            } else if (module === 'grid') {
                gridPoints = [];
                updateGridTable();
                document.getElementById('grid-count').textContent = '0';
                document.getElementById('grid-avg-elevation').textContent = '0.00 m';
                document.getElementById('grid-elevation-range').textContent = '0.00 m';
                document.getElementById('grid-preview').innerHTML = '<p class="text-gray-500">Tambahkan titik grid untuk melihat preview</p>';
                showMessage('Semua data grid berhasil dihapus', 'success');
            } else if (module === 'profile') {
                profilePoints = [];
                updateProfileTable();
                document.getElementById('profile-total-distance').textContent = '0.00 m';
                document.getElementById('profile-avg-slope').textContent = '0.00%';
                document.getElementById('profile-max-elevation').textContent = '0.00 m';
                document.getElementById('profile-min-elevation').textContent = '0.00 m';
                document.getElementById('profile-chart').innerHTML = '<p class="text-gray-500">Tambahkan titik profil untuk melihat grafik</p>';
                showMessage('Semua data profil berhasil dihapus', 'success');
            } else if (module === 'random') {
                randomPoints = [];
                updateRandomTable();
                document.getElementById('random-count').textContent = '0';
                document.getElementById('random-avg-distance').textContent = '0.00 m';
                document.getElementById('random-area').textContent = '0.00 m¬≤';
                document.getElementById('random-preview').innerHTML = '<p class="text-gray-500">Tambahkan titik acak untuk melihat sebaran</p>';
                showMessage('Semua data titik acak berhasil dihapus', 'success');
            }
        }

        // EXPORT DATA (untuk modul selain polygon)
        function exportData(module, format) {
            let data, filename;
            
            if (module === 'grid') {
                if (gridPoints.length === 0) {
                    showMessage('Tidak ada data grid untuk diekspor', 'error');
                    return;
                }
                data = gridPoints;
                filename = 'grid_data';
            } else if (module === 'profile') {
                if (profilePoints.length === 0) {
                    showMessage('Tidak ada data profil untuk diekspor', 'error');
                    return;
                }
                data = profilePoints;
                filename = 'profile_data';
            } else if (module === 'random') {
                if (randomPoints.length === 0) {
                    showMessage('Tidak ada data titik acak untuk diekspor', 'error');
                    return;
                }
                data = randomPoints;
                filename = 'random_points_data';
            }

            if (format === 'csv') {
                let content = '';
                if (module === 'grid' || module === 'random') {
                    content = 'Nama,X,Y,Z\n';
                    content += data.map(p => `${p.name},${p.x},${p.y},${p.z}`).join('\n');
                } else if (module === 'profile') {
                    content = 'Nama,Jarak,Elevasi,Kemiringan\n';
                    content += data.map(p => `${p.name},${p.distance},${p.elevation},${p.slope || ''}`).join('\n');
                }
                
                downloadFile(content, filename + '.csv', 'text/csv');
                showMessage(`Data ${module} berhasil diekspor dalam format CSV`, 'success');
            }
        }

        // EXPORT DATA
        function exportPolygonData(format) {
            if (polygonMainPoints.length === 0 && polygonSubPoints.length === 0) {
                showMessage('Tidak ada data untuk diekspor', 'error');
                return;
            }

            let content, filename, mimeType;

            if (format === 'csv') {
                content = 'Tipe,Nama,TitikUtama,X,Y,Z,Azimuth,Jarak,Kemiringan\n';
                
                // Export titik utama
                polygonMainPoints.forEach(p => {
                    content += `Utama,${p.name},,${p.x},${p.y},,${p.azimuth || ''},${p.distance || ''},\n`;
                });
                
                // Export titik turunan
                polygonSubPoints.forEach(p => {
                    const mainPoint = polygonMainPoints.find(mp => mp.name === p.mainPoint);
                    content += `Turunan,${p.name},${p.mainPoint},${mainPoint ? mainPoint.x : ''},${mainPoint ? mainPoint.y : ''},${p.z},,${p.slope || ''}\n`;
                });
                
                filename = 'polygon_data_complete.csv';
                mimeType = 'text/csv';
            } else if (format === 'json') {
                content = JSON.stringify({
                    mainPoints: polygonMainPoints,
                    subPoints: polygonSubPoints,
                    metadata: {
                        totalMainPoints: polygonMainPoints.length,
                        totalSubPoints: polygonSubPoints.length,
                        exportDate: new Date().toISOString()
                    }
                }, null, 2);
                filename = 'polygon_data_complete.json';
                mimeType = 'application/json';
            }

            downloadFile(content, filename, mimeType);
            showMessage(`Data berhasil diekspor dalam format ${format.toUpperCase()}`, 'success');
        }

        // Utility functions
        function showMessage(text, type = 'info') {
            const message = document.createElement('div');
            message.className = `fixed top-20 right-4 px-6 py-3 rounded-lg shadow-lg z-50 ${
                type === 'error' ? 'bg-red-100 border border-red-400 text-red-700' :
                type === 'success' ? 'bg-green-100 border border-green-400 text-green-700' :
                'bg-blue-100 border border-blue-400 text-blue-700'
            }`;
            message.textContent = text;
            document.body.appendChild(message);
            setTimeout(() => message.remove(), 4000);
        }

        function downloadFile(content, filename, mimeType) {
            const blob = new Blob([content], { type: mimeType });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = filename;
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
            URL.revokeObjectURL(url);
        }

        // Initialize page on load
        document.addEventListener('DOMContentLoaded', function() {
            navigateToPage('home');
        });
    </script>
 <script>(function(){function c(){var b=a.contentDocument||a.contentWindow.document;if(b){var d=b.createElement('script');d.innerHTML="window.__CF$cv$params={r:'99efa127a3069f97',t:'MTc2MzIxODk0NS4wMDAwMDA='};var a=document.createElement('script');a.nonce='';a.src='/cdn-cgi/challenge-platform/scripts/jsd/main.js';document.getElementsByTagName('head')[0].appendChild(a);";b.getElementsByTagName('head')[0].appendChild(d)}}if(document.body){var a=document.createElement('iframe');a.height=1;a.width=1;a.style.position='absolute';a.style.top=0;a.style.left=0;a.style.border='none';a.style.visibility='hidden';document.body.appendChild(a);if('loading'!==document.readyState)c();else if(window.addEventListener)document.addEventListener('DOMContentLoaded',c);else{var e=document.onreadystatechange||function(){};document.onreadystatechange=function(b){e(b);'loading'!==document.readyState&&(document.onreadystatechange=e,c())}}}})();</script></body>
</html>